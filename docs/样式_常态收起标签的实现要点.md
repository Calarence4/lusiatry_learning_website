# 常态收起标签的实现要点

## 概述

实现一组书签式标签，常态下隐藏在卡片后面只露出图标部分，鼠标悬停时向左滑出显示完整内容。

## 最终效果

- 标签位于卡片左侧，大部分隐藏在卡片下方
- 常态只露出图标（约18-22px）
- 选中的标签比未选中的多露出约4px
- 鼠标悬停时完整滑出
- 平滑的过渡动画

## 核心实现代码

```jsx
{/* 容器：卡片整体右移5px，为标签腾出空间 */}
<div className="relative flex-1 min-h-[500px] ml-[5px]">
    
    {/* 标签容器：定位在卡片左外侧，z-index低于卡片 */}
    <div className="absolute -left-20 top-6 z-10 flex flex-col gap-1">
        {statusTabs.map((tab) => (
            <button
                className={`flex items-center py-2 pl-2 pr-3 w-20 text-xs font-bold 
                    whitespace-nowrap transition-all duration-300 ease-out 
                    rounded-l-lg shadow-md ${tab.color} text-white
                    ${isActive
                        ? 'translate-x-[58px] hover:translate-x-0'
                        : 'translate-x-[62px] opacity-80 hover:translate-x-0 hover:opacity-100'
                    }`}
            >
                <Icon size={14} className="shrink-0" />
                <span className="ml-1.5">{tab.label}</span>
                <span className="ml-1.5 text-[10px] opacity-80">{tab.count}</span>
            </button>
        ))}
    </div>

    {/* 卡片内容：z-index高于标签，遮住标签主体 */}
    <div className="... relative z-20">
        {/* 卡片内容 */}
    </div>
</div>
```

## 关键技术点

### 1. z-index 层级控制

```
标签容器: z-10 (底层)
卡片内容: z-20 (顶层)
```

**要点**：卡片的 z-index 必须高于标签，才能实现"隐藏在卡片后面"的效果。

### 2. 定位与偏移计算

```
容器位置: -left-20 (-80px，即标签宽度)
标签宽度: w-20 (80px 固定宽度)
```

**计算逻辑**：
- 标签容器整体放在卡片左边外侧 80px 处
- 通过 `translate-x` 将标签推回到卡片下方
- 露出部分 = 标签宽度(80px) - translate-x值

### 3. translate-x 方向理解（反复修改的关键）

**错误理解**：
```jsx
// ❌ 错误：使用负值让标签"移出来"
translate-x-[calc(100%-20px)]  // 效果相反
```

**正确理解**：
```jsx
// ✅ 正确：标签在左侧，使用正值向右推入卡片下方
translate-x-[58px]   // 向右移动58px，露出 80-58=22px
translate-x-[62px]   // 向右移动62px，露出 80-62=18px
```

### 4. 固定宽度防抖动

```jsx
w-20  // 固定80px宽度
```

**问题**：如果不固定宽度，悬停时内容展开会改变元素宽度，导致鼠标位置相对变化，触发反复的 hover/unhover，造成"抽搐"效果。

**解决**：使用固定宽度，悬停只改变 `translate-x`，不改变元素尺寸。

### 5. 选中状态区分

```jsx
isActive
    ? 'translate-x-[58px]'   // 选中：多露出4px
    : 'translate-x-[62px]'   // 未选中：少露4px
```

通过微小的露出差异，让用户能识别当前选中的标签。

### 6. 内容排列顺序

```jsx
// 从左到右：图标 → 文字 → 数字
<Icon />
<span>{tab.label}</span>
<span>{tab.count}</span>
```

**要点**：图标放在最左边，因为露出的是左侧部分。

## 反复修改的原因总结

| 问题 | 原因 | 解决方案 |
|------|------|----------|
| 标签没有隐藏在卡片后 | z-index 设置错误，标签层级高于卡片 | 标签 z-10，卡片 z-20 |
| 常态展开，悬停收起 | translate-x 方向理解错误 | 左侧标签用正值推入，悬停归零展开 |
| 悬停时标签抽搐 | 元素宽度随内容变化，触发反复hover | 使用固定宽度 w-20 |
| 未选中标签不显示 | translate-x 值过大，完全推入卡片下方 | 调整容器位置 -left-20，重新计算偏移值 |
| 图标位置不对 | 内容顺序错误，图标在右侧（被遮住的部分） | 调整为图标在最左边 |

## 通用实现模式

如需在其他地方实现类似效果，遵循以下模式：

1. **外层容器**：`relative`，给标签留出空间（margin）
2. **标签容器**：`absolute` 定位在外侧，低 `z-index`
3. **内容卡片**：高 `z-index`，遮住标签
4. **标签元素**：固定宽度，使用 `translate` 控制露出量
5. **悬停效果**：`hover:translate-x-0` 或 `hover:translate-y-0`
