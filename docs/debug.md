# Bug 修复清单

## 优先级：高

### ✅ 1. 打卡任务 - 截止时间和时长必填
- **位置**: `CheckIn.jsx` - 新建任务表单
- **问题**: 截止时间和预期时长应为必填项，当前可以跳过
- **修复**: 添加表单验证，必填字段缺失时标红摇晃提示
- **状态**: 已完成 ✅已校验

### ✅ 2. 主页待解决问题数不刷新
- **位置**: `Home.jsx`
- **问题**: 提交问题后，主页的"待解决问题"数量没有实时更新
- **修复**: 添加数据刷新逻辑，LearningRecorder 通过 onDataChange 回调通知父组件
- **状态**: 已完成 ✅已校验

### ✅ 3. 待归档数目错误
- **位置**: `LearningRecorder.jsx`
- **问题**: 显示的待归档数应为草稿箱中的总文件数
- **修复**: 使用递归函数 countFiles 统计草稿箱下所有文件
- **状态**: 已完成 ✅未解决X

### ✅ 4. 课程信息更新 500 错误
- **位置**: `EditCourseModal.jsx`, `useCourseData.js`
- **问题**: 更新课程信息,一般为更新学科状态时返回 500 服务器错误;且修改学科时,学科默认错误显示为6
- **修复**: 修复学科字段类型问题，使用 subjectId (INT) 而非 subject 字符串
- **状态**: 已完成 ✅已解决

### ✅ 5. 自定义追踪项出现负数
- **位置**: `EditCourseModal.jsx`, `EditableProgress.jsx`
- **问题**: 追踪项数值可能为负数
- **修复**: 添加 Math.max(0, ...) 校验，限制最小值为0
- **状态**: 已完成 ✅已校验

### ✅ 6. 课程卡片颜色排序错误
- **位置**: `backend/controllers/coursesController.js`
- **问题**: 卡片默认颜色分配顺序不正确,当前默认为无色
- **修复**: 创建课程时根据现有课程数量自动分配颜色
- **状态**: 已完成 ✅已校验

### ✅ 7. 总课时必须大于 1
- **位置**: `EditCourseModal.jsx`, `useCourseData.js`, `index.jsx`
- **问题**: 总课时应校验 ≥ 1
- **修复**: 添加 Math.max(1, ...) 校验和提示信息
- **状态**: 已完成 ✅已校验

### ✅ 8. 编辑区问题
- **位置**: 课程编辑区域
- **问题**: 编辑区存在多个报错
- **修复**: 无编译错误，已增强进度校验逻辑
- **状态**: 已完成 ✅已校验

### ✅ 9. 问题集关联笔记不存在
- **位置**: `Questions.jsx`
- **问题**: 关联笔记时可能没有可选笔记
- **修复**: 添加空状态提示，显示"前往知识库创建笔记"链接
- **状态**: 已完成 ✅待验证

### ✅ 10. 草稿名不对齐
- **位置**: `KnowledgeBase.jsx` - FileTreeItem
- **问题**: 草稿文件名显示不对齐
- **修复**: 调整 flex 布局，增加 gap-2，统一图标容器宽高
- **状态**: 已完成 ✅未解决

---

## 优先级：中

### 11. 知识库文件/笔记创建逻辑
- **问题**: 创建流程不清晰，存在多处问题
- **修复**: 需要整体重构（标记为后续任务）

### 12. 创建文件夹逻辑优化
- **问题**: 文件夹创建体验不佳
- **修复**: 优化交互流程,流畅可用,参考本地的资源管理系统(如Obsidian,VScode的文件交互逻辑)（标记为后续任务）

---

## UI/UX 改进

### ✅ 13. 移除系统提示框
- **问题**: 当前使用 `alert()` 系统弹窗，风格不统一
- **修复**: 
  - ✅ 实现自定义 Toast 组件 (`components/Toast.jsx`)
  - ✅ 必填字段缺失时：输入框边框标红 + 摇晃动画
  - ✅ 成功/错误提示：使用 Toast 通知
  - ✅ 替换所有页面的 alert() 为 toast
- **状态**: 已完成 ✅

---

## 知识库重构（单独任务）
知识库模块存在大量问题，需要整体重构：
- 文件创建逻辑
- 文件夹管理
- 笔记编辑体验
- 草稿箱功能

**注意**: 此任务标记为后续迭代，需要更多时间和规划。
